<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Seu Resultado ‚Äî SPP Carreira</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,400&display=swap" rel="stylesheet">
<style>
:root{
  --amber:#E8870A;--amber-h:#C97208;--amber-light:#FFF3E0;
  --ink:#0D0C0B;--ink2:#1A1917;--ink3:#2A2826;
  --cream:#F9F8F4;--off:#F2F1EC;--white:#FFFFFF;
  --muted:#8C8A82;--border:#E6E4DC;
  --green:#176334;--green-bg:#EBF5EF;
  --f:'Plus Jakarta Sans',sans-serif;
}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{font-family:var(--f);background:var(--ink);color:#fff;overflow-x:hidden;}

/* LOADING */
#loading{
  position:fixed;inset:0;background:var(--ink);z-index:999;
  display:flex;flex-direction:column;align-items:center;justify-content:center;gap:20px;
}
.load-ring{
  width:56px;height:56px;border-radius:50%;
  border:3px solid rgba(232,135,10,0.15);border-top-color:var(--amber);
  animation:spin 0.9s linear infinite;
}
.load-text{font-size:15px;color:rgba(255,255,255,0.4);font-weight:500;}
@keyframes spin{to{transform:rotate(360deg);}}

/* NAV */
nav{
  padding:0 40px;height:58px;
  display:flex;align-items:center;justify-content:space-between;
  border-bottom:1px solid rgba(255,255,255,0.06);
  background:rgba(13,12,11,0.9);backdrop-filter:blur(16px);
  position:sticky;top:0;z-index:50;
}
.logo{display:flex;align-items:center;gap:9px;text-decoration:none;}
.lm{width:30px;height:30px;background:var(--amber);border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:800;color:#fff;}
.lt{font-size:13px;font-weight:800;color:#fff;}.lt span{color:var(--amber);}
.nav-back{font-size:13px;color:rgba(255,255,255,0.35);text-decoration:none;transition:color 0.2s;font-weight:500;}
.nav-back:hover{color:rgba(255,255,255,0.7);}

/* HERO RESULT */
.result-hero{
  padding:72px 24px 56px;text-align:center;
  background:linear-gradient(180deg,rgba(232,135,10,0.05) 0%,transparent 100%);
  border-bottom:1px solid rgba(255,255,255,0.05);
  position:relative;overflow:hidden;
}
.result-hero::before{
  content:'';position:absolute;
  width:600px;height:400px;border-radius:50%;
  background:radial-gradient(ellipse,rgba(232,135,10,0.06),transparent 70%);
  top:-100px;left:50%;transform:translateX(-50%);pointer-events:none;
}
.result-badge{
  display:inline-block;background:rgba(232,135,10,0.1);
  border:1px solid rgba(232,135,10,0.22);color:var(--amber);
  font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;
  padding:6px 16px;border-radius:100px;margin-bottom:20px;
}
.result-name{font-size:clamp(28px,5vw,56px);font-weight:800;color:#fff;line-height:1.05;letter-spacing:-1.5px;margin-bottom:8px;}
.result-name em{font-style:italic;color:var(--amber);font-weight:300;}
.result-archetype-label{font-size:14px;color:rgba(255,255,255,0.4);margin-bottom:32px;}
.result-archetype{
  display:inline-block;font-size:clamp(20px,4vw,36px);font-weight:800;
  color:#fff;letter-spacing:-0.5px;margin-bottom:8px;
}
.archetype-phrase{font-size:15px;color:rgba(255,255,255,0.5);font-style:italic;margin-bottom:36px;}

/* SCORE */
.score-wrap{max-width:480px;margin:0 auto 48px;}
.score-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;}
.score-label{font-size:12px;color:rgba(255,255,255,0.4);font-weight:600;letter-spacing:0.5px;}
.score-num{font-size:28px;font-weight:800;color:var(--amber);}
.score-track{height:8px;background:rgba(255,255,255,0.07);border-radius:4px;overflow:hidden;}
.score-fill{height:100%;background:linear-gradient(90deg,var(--amber),#FFB347);border-radius:4px;transition:width 1.5s cubic-bezier(0.4,0,0.2,1);width:0;}

/* ANALYSIS GRID */
.analysis{padding:64px 24px;background:var(--ink2);}
.a-inner{max-width:960px;margin:0 auto;}
.a-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-top:40px;}
.a-card{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.07);border-radius:16px;padding:28px;}
.a-card-title{font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;margin-bottom:16px;}
.a-item{font-size:14px;color:rgba(255,255,255,0.65);line-height:1.65;margin-bottom:10px;display:flex;align-items:flex-start;gap:8px;}
.a-item:last-child{margin-bottom:0;}
.a-dot{width:5px;height:5px;border-radius:50%;flex-shrink:0;margin-top:7px;}

/* SKILLS */
.skills-section{padding:64px 24px;background:var(--ink);}
.sk-inner{max-width:760px;margin:0 auto;}
.sk-title{font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,0.3);margin-bottom:14px;}
.sk-tags{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:32px;}
.sk-tag{
  background:rgba(232,135,10,0.1);border:1px solid rgba(232,135,10,0.2);
  color:var(--amber);font-size:12px;font-weight:700;
  padding:6px 14px;border-radius:100px;
}
.sk-soft{font-size:14px;color:rgba(255,255,255,0.55);line-height:1.8;}
.sk-soft strong{color:rgba(255,255,255,0.8);}

/* TRANSITION */
.transition-block{
  padding:56px 24px;background:var(--ink2);
  border-top:1px solid rgba(255,255,255,0.05);border-bottom:1px solid rgba(255,255,255,0.05);
  text-align:center;
}
.tb-inner{max-width:640px;margin:0 auto;}
.tb-eyebrow{font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--amber);margin-bottom:14px;}
.tb-title{font-size:clamp(22px,4vw,36px);font-weight:800;color:#fff;line-height:1.15;letter-spacing:-0.5px;margin-bottom:12px;}
.tb-sub{font-size:15px;color:rgba(255,255,255,0.4);line-height:1.75;margin-bottom:0;}

/* CV PREVIEW */
.cv-preview{padding:64px 24px;background:var(--ink);}
.cv-inner{max-width:760px;margin:0 auto;}
.cv-device{
  background:#fff;border-radius:16px;overflow:hidden;
  box-shadow:0 32px 80px rgba(0,0,0,0.5);
  border:1px solid rgba(255,255,255,0.05);
}
.cv-bar{
  background:#F2F1EC;border-bottom:1px solid #E6E4DC;
  padding:11px 18px;display:flex;align-items:center;gap:7px;
}
.cv-dot{width:10px;height:10px;border-radius:50%;}
.cv-fn{margin-left:10px;font-size:12px;color:#8C8A82;font-family:var(--f);}
.cv-body{padding:36px 44px;font-family:var(--f);}
.cv-name{font-size:28px;font-weight:800;color:var(--ink);letter-spacing:-0.5px;}
.cv-role{font-size:13px;font-weight:700;color:var(--amber-h);margin:5px 0 12px;}
.cv-contact{display:flex;gap:18px;flex-wrap:wrap;margin-bottom:18px;}
.cv-ci{font-size:11px;color:var(--muted);}
.cv-line{height:2px;background:var(--amber);border-radius:1px;margin-bottom:18px;}
.cv-st{font-size:9px;font-weight:700;letter-spacing:2.5px;text-transform:uppercase;color:var(--amber-h);margin-bottom:9px;}
.cv-summary{font-size:13px;color:var(--ink3);line-height:1.8;margin-bottom:22px;}
.cv-blur-wrap{position:relative;}
.cv-blur{filter:blur(5px);user-select:none;pointer-events:none;}
.cv-bl{height:10px;background:#E6E4DC;border-radius:4px;margin-bottom:8px;}
.cv-lock{
  position:absolute;inset:0;
  background:linear-gradient(to bottom,transparent,rgba(255,255,255,0.8) 28%,rgba(255,255,255,0.98));
  display:flex;flex-direction:column;align-items:center;justify-content:flex-end;
  padding-bottom:28px;gap:5px;
}
.cv-li{font-size:20px;}
.cv-lt{font-size:14px;font-weight:800;color:var(--ink);}
.cv-ls{font-size:12px;color:var(--muted);text-align:center;max-width:220px;}

/* PRICE BLOCK */
.price-section{padding:64px 24px;background:var(--ink2);}
.price-inner{max-width:580px;margin:0 auto;}
.price-card{
  background:rgba(232,135,10,0.07);border:1px solid rgba(232,135,10,0.18);
  border-radius:20px;padding:36px;text-align:center;
}
.price-includes{
  display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:28px;text-align:left;
}
.pi-item{display:flex;align-items:center;gap:9px;font-size:13px;color:rgba(255,255,255,0.55);}
.pi-check{color:var(--amber);font-weight:800;font-size:13px;}
.price-from{font-size:13px;color:rgba(255,255,255,0.22);text-decoration:line-through;margin-bottom:4px;}
.price-main{font-size:clamp(48px,8vw,72px);font-weight:800;color:var(--amber);line-height:1;margin-bottom:6px;}
.price-main sup{font-size:22px;vertical-align:top;margin-top:12px;display:inline-block;}
.price-note{font-size:12px;color:rgba(255,255,255,0.25);margin-bottom:26px;line-height:1.6;}
.btn-buy{
  display:block;width:100%;background:var(--amber);color:#fff;
  font-family:var(--f);font-size:16px;font-weight:800;
  padding:18px;border-radius:100px;border:none;cursor:pointer;
  box-shadow:0 8px 32px rgba(232,135,10,0.32);transition:all 0.25s;
}
.btn-buy:hover{background:var(--amber-h);transform:translateY(-2px);box-shadow:0 16px 48px rgba(232,135,10,0.38);}
.price-trust{font-size:12px;color:rgba(255,255,255,0.18);margin-top:14px;display:flex;align-items:center;justify-content:center;gap:16px;flex-wrap:wrap;}

/* ADVANCED FLOW */
.advanced-block{
  background:linear-gradient(135deg,rgba(23,99,52,0.15),rgba(232,135,10,0.07));
  border:1px solid rgba(23,99,52,0.22);border-radius:20px;padding:40px;
  text-align:center;margin-top:32px;
}
.adv-badge{display:inline-block;background:var(--green-bg);color:var(--green);font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:5px 14px;border-radius:100px;margin-bottom:18px;}
.adv-title{font-size:clamp(20px,3vw,28px);font-weight:800;color:#fff;margin-bottom:12px;letter-spacing:-0.3px;}
.adv-text{font-size:14px;color:rgba(255,255,255,0.5);line-height:1.8;max-width:440px;margin:0 auto 24px;}
.adv-form{display:flex;gap:9px;max-width:380px;margin:0 auto 14px;}
.adv-input{flex:1;background:rgba(255,255,255,0.07);border:1px solid rgba(255,255,255,0.12);border-radius:11px;padding:13px 15px;font-family:var(--f);font-size:13px;color:#fff;outline:none;}
.adv-input::placeholder{color:rgba(255,255,255,0.22);}
.btn-adv{background:var(--green);color:#fff;font-family:var(--f);font-size:13px;font-weight:700;padding:13px 20px;border-radius:11px;border:none;cursor:pointer;white-space:nowrap;transition:background 0.2s;}
.btn-adv:hover{background:#135228;}
.adv-cv-link{font-size:12px;color:rgba(255,255,255,0.25);}
.adv-cv-link a{color:rgba(232,135,10,0.55);cursor:pointer;text-decoration:underline;}

@keyframes up{from{opacity:0;transform:translateY(16px);}to{opacity:1;transform:translateY(0);}}
@media(max-width:760px){.a-grid{grid-template-columns:1fr;}.price-includes{grid-template-columns:1fr;}.cv-body{padding:24px 20px;}.adv-form{flex-direction:column;}}
</style>
</head>
<body>

<div id="loading">
  <div class="load-ring"></div>
  <p class="load-text">Gerando sua an√°lise...</p>
</div>

<div id="result-page" style="display:none;">

<nav>
  <a href="index.html" class="logo"><div class="lm">SPP</div><span class="lt">SPP <span>Carreira</span></span></a>
  <a href="index.html" class="nav-back">‚Üê Voltar ao in√≠cio</a>
</nav>

<div id="result-content"></div>

</div>

<script>
// ‚îÄ‚îÄ ARCHETYPES ‚îÄ‚îÄ
const ARCHETYPES = {
  executor:{
    name:'O Executor',
    phrase:'"Voc√™ n√£o espera ‚Äî voc√™ faz acontecer."',
    score:78,
    color:'#E8870A'
  },
  estrategista:{
    name:'O Estrategista',
    phrase:'"Voc√™ v√™ o que os outros n√£o veem antes de agir."',
    score:82,
    color:'#E8870A'
  },
  construtor:{
    name:'O Construtor',
    phrase:'"Voc√™ n√£o segue caminhos ‚Äî voc√™ abre."',
    score:75,
    color:'#E8870A'
  },
  conector:{
    name:'O Conector',
    phrase:'"Seu maior ativo √© como voc√™ faz as pessoas se sentirem."',
    score:80,
    color:'#E8870A'
  },
  especialista:{
    name:'O Especialista',
    phrase:'"Voc√™ √© a pessoa que chamam quando o problema √© dif√≠cil."',
    score:85,
    color:'#E8870A'
  },
  adaptador:{
    name:'O Adaptador',
    phrase:'"Incerteza √© onde voc√™ performa melhor."',
    score:72,
    color:'#E8870A'
  },
  protagonista:{
    name:'O Protagonista',
    phrase:'"Voc√™ n√£o nasceu para ficar em segundo plano."',
    score:77,
    color:'#E8870A'
  },
  transformador:{
    name:'O Transformador',
    phrase:'"Voc√™ trabalha melhor quando acredita no que est√° fazendo."',
    score:74,
    color:'#E8870A'
  },
};

// ‚îÄ‚îÄ MODEL MAP ‚îÄ‚îÄ
const MODEL_MAP = {
  'iniciante-universitario':'Modelo Universit√°rio SPP',
  'iniciante-recem-formado':'Modelo Rec√©m-Formado SPP',
  'iniciante-sem-faculdade':'Modelo Entrada de Mercado SPP',
  'iniciante-outro-i':'Modelo Universit√°rio SPP',
  'intermediario-digital':'Modelo Migra√ß√£o Digital SPP',
  'intermediario-tech':'Modelo Tech & Dados SPP',
  'intermediario-adm':'Modelo Corporativo Pro SPP',
  'intermediario-saude':'Modelo Sa√∫de Profissional SPP',
  'intermediario-outro-m':'Modelo Corporativo Pro SPP',
};

// ‚îÄ‚îÄ ARCHETYPE ALGORITHM (deterministic) ‚îÄ‚îÄ
function computeArchetype(Q){
  const scores = {executor:0,estrategista:0,construtor:0,conector:0,especialista:0,adaptador:0,protagonista:0,transformador:0};
  // Etapa 3 ‚Äî objetivo
  const obj = Q.answers['3'];
  if(obj==='reconhecido') {scores.executor+=2;scores.protagonista+=2;}
  if(obj==='crescer') {scores.protagonista+=2;scores.executor+=1;scores.construtor+=1;}
  if(obj==='proposito') {scores.transformador+=3;scores.conector+=1;}
  if(obj==='liberdade') {scores.construtor+=3;scores.adaptador+=1;}
  // Etapa 4 ‚Äî como resolve
  const res = Q.answers['4'];
  if(res==='analise') {scores.estrategista+=3;scores.especialista+=2;}
  if(res==='acao') {scores.executor+=3;scores.adaptador+=1;}
  if(res==='colabo') {scores.conector+=3;scores.transformador+=1;}
  if(res==='visao') {scores.estrategista+=2;scores.construtor+=2;}
  // Etapa 5 ‚Äî motiva√ß√£o
  const mot = Q.answers['5'];
  if(mot==='meta') {scores.executor+=2;scores.especialista+=1;}
  if(mot==='criacao') {scores.construtor+=2;scores.protagonista+=1;}
  if(mot==='desafio') {scores.especialista+=2;scores.executor+=1;}
  if(mot==='crescimento') {scores.adaptador+=2;scores.transformador+=1;}
  // Pick highest
  return Object.entries(scores).sort((a,b)=>b[1]-a[1])[0][0];
}

// ‚îÄ‚îÄ SCORE CALCULATION ‚îÄ‚îÄ
function computeScore(archetypeKey, Q){
  const base = ARCHETYPES[archetypeKey].score;
  let bonus = 0;
  if(Q.answers['7'] && Q.answers['7'].length>=2) bonus+=4;
  if(Q.answers['8'] && Q.answers['8'].length>80) bonus+=3;
  if(Q.level==='intermediario') bonus+=2;
  return Math.min(base+bonus, 97);
}

// ‚îÄ‚îÄ PROMPTS CONFIG (editable) ‚îÄ‚îÄ
const PROMPTS = {
  perfil:(data)=>`Voc√™ √© um especialista em desenvolvimento de carreira e posicionamento profissional.

Com base no perfil abaixo, escreva um par√°grafo de apresenta√ß√£o do arqu√©tipo profissional dessa pessoa.

REGRAS:
- Exatamente 3 frases
- Segunda pessoa ("Voc√™ √©...", "Voc√™ funciona melhor...")
- Tom: direto, humano, respeitoso ‚Äî como um mentor que conhece a pessoa
- Frase 1: define quem a pessoa √© profissionalmente
- Frase 2: descreve como ela naturalmente opera
- Frase 3: conecta esse perfil ao objetivo declarado
- N√ÉO mencione curr√≠culo, SPP ou qualquer produto
- N√ÉO invente informa√ß√µes n√£o fornecidas
- N√ÉO use: "dedicado", "proativo", "din√¢mico", "apaixonado"

PERFIL:
Arqu√©tipo: ${data.archetype}
Objetivo: ${data.objetivo}
Como resolve problemas: ${data.resolve}
O que motiva: ${data.motiva}
√Årea: ${data.area}
N√≠vel: ${data.nivel}
Trajet√≥ria: ${data.trajetoria}

Responda APENAS com o par√°grafo. Sem t√≠tulo, sem aspas.`,

  fortes:(data)=>`Voc√™ √© um especialista em RH e avalia√ß√£o comportamental.

Com base no perfil, escreva exatamente 3 pontos fortes profissionais.

REGRAS:
- Cada ponto: m√°ximo 12 palavras
- Baseados nas respostas ‚Äî n√£o invente
- Espec√≠ficos, n√£o gen√©ricos
- Tom: "Capacidade de...", "Habilidade para...", "Facilidade em..."
- 3 naturezas distintas: comportamental, t√©cnica, relacional

PERFIL:
Arqu√©tipo: ${data.archetype}
Como resolve: ${data.resolve}
O que motiva: ${data.motiva}
Habilidades: ${data.habilidades}
Trajet√≥ria: ${data.trajetoria}
Objetivo: ${data.objetivo}

Responda com os 3 pontos, um por linha, sem numera√ß√£o, sem bullets.`,

  desenvolver:(data)=>`Voc√™ √© especialista em desenvolvimento de carreira.

Com base no perfil, escreva 2 pontos de desenvolvimento.

REGRAS:
- Cada ponto: m√°ximo 14 palavras
- Tom construtivo ‚Äî √© oportunidade, n√£o cr√≠tica
- Baseados no gap entre perfil atual e objetivo
- Espec√≠ficos e acion√°veis
- Come√ßar com verbo infinitivo: "Desenvolver...", "Fortalecer...", "Aprofundar..."

PERFIL:
Arqu√©tipo: ${data.archetype}
Objetivo: ${data.objetivo}
N√≠vel: ${data.nivel}
O que trava: ${data.trava}
Habilidades: ${data.habilidades}
Trajet√≥ria: ${data.trajetoria}

Responda com os 2 pontos, um por linha, sem numera√ß√£o.`,

  posicionamento:(data)=>`Voc√™ √© especialista em posicionamento de carreira no mercado brasileiro.

Escreva uma recomenda√ß√£o de posicionamento profissional.

REGRAS:
- Exatamente 2 frases
- Pr√°tico e espec√≠fico ‚Äî diz O QUE fazer
- Conecta arqu√©tipo ao objetivo
- Linguagem de mercado
- N√ÉO seja vago. N√ÉO mencione curr√≠culo ou SPP.

PERFIL:
Arqu√©tipo: ${data.archetype}
Objetivo: ${data.objetivo}
√Årea: ${data.area}
N√≠vel: ${data.nivel}
Habilidades: ${data.habilidades}

Responda com as 2 frases. Sem t√≠tulo, sem aspas.`,

  sobreMim:(data)=>`Voc√™ √© especialista em reda√ß√£o de curr√≠culos brasileiros.

Escreva o "Sobre mim" para o curr√≠culo dessa pessoa.

REGRAS:
- Exatamente 3 frases
- Primeira pessoa
- Tom: profissional e humano
- Frase 1: identidade e √°rea
- Frase 2: diferencial baseado no arqu√©tipo e habilidades reais
- Frase 3: objetivo profissional direto
- USE apenas informa√ß√µes fornecidas
- Se trajet√≥ria curta: foque em potencial e dire√ß√£o
- N√ÉO use: "profissional dedicado", "busco crescimento", "apaixonado por"
- N√ÉO mencione SPP

PERFIL:
Nome: ${data.nome}
Cargo desejado: ${data.cargo}
Arqu√©tipo: ${data.archetype}
√Årea: ${data.area}
N√≠vel: ${data.nivel}
Objetivo: ${data.objetivo}
Habilidades: ${data.habilidades}
Trajet√≥ria: ${data.trajetoria}

Responda APENAS com o par√°grafo.`,

  softSkills:(data)=>`Voc√™ √© especialista em RH e reda√ß√£o de curr√≠culos.

Escreva 4 soft skills para o curr√≠culo.

REGRAS:
- 3 a 6 palavras cada, substantivo + contexto
- NUNCA palavras soltas ("Lideran√ßa", "Comunica√ß√£o")
- Sempre contextualize: "Lideran√ßa orientada a resultado"
- Baseadas no arqu√©tipo e respostas
- 4 naturezas distintas

PERFIL:
Arqu√©tipo: ${data.archetype}
Como resolve: ${data.resolve}
O que motiva: ${data.motiva}
√Årea: ${data.area}
Objetivo: ${data.objetivo}

Responda com as 4 soft skills, uma por linha, sem numera√ß√£o.`,
};

// ‚îÄ‚îÄ CLASSIFY OPEN AREA ‚îÄ‚îÄ
async function classifyOpenArea(text){
  try{
    const res = await callClaude(`Classifique a √°rea profissional abaixo em UMA das categorias.

√ÅREA: ${text}

CATEGORIAS:
- digital
- tech
- adm
- saude
- universitario
- recem-formado
- sem-faculdade
- liberal

Responda APENAS com o nome da categoria. Uma palavra.`);
    const cat = res.trim().toLowerCase();
    const valid=['digital','tech','adm','saude','universitario','recem-formado','sem-faculdade','liberal'];
    return valid.includes(cat) ? cat : 'adm';
  }catch(e){return 'adm';}
}

// ‚îÄ‚îÄ CLAUDE API ‚îÄ‚îÄ
async function callClaude(prompt){
  const res = await fetch('https://api.anthropic.com/v1/messages',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({
      model:'claude-sonnet-4-20250514',
      max_tokens:400,
      messages:[{role:'user',content:prompt}]
    })
  });
  const data = await res.json();
  return data.content?.[0]?.text?.trim()||'';
}

// ‚îÄ‚îÄ FALLBACKS ‚îÄ‚îÄ
function fallbackPerfil(archetype, nome, cargo){
  const n = nome.split(' ')[0];
  const map = {
    executor:`${n}, voc√™ √© um profissional orientado a resultado que transforma decis√µes em a√ß√£o. Voc√™ funciona melhor quando tem clareza de meta e liberdade para executar no seu ritmo. Sua dire√ß√£o para ${cargo} √© constru√≠da na consist√™ncia de entrega.`,
    estrategista:`${n}, voc√™ √© algu√©m que enxerga padr√µes e estrutura antes de agir. Voc√™ funciona melhor quando tem tempo para an√°lise e espa√ßo para pensar com profundidade. Como ${cargo}, seu diferencial est√° na qualidade das suas decis√µes.`,
    construtor:`${n}, voc√™ √© um profissional que prefere criar do que seguir. Voc√™ funciona melhor quando tem autonomia para construir algo do zero. Sua trajet√≥ria como ${cargo} ser√° marcada por iniciativas que voc√™ colocou no mundo.`,
    conector:`${n}, voc√™ √© algu√©m que mobiliza pessoas e constr√≥i rela√ß√µes com prop√≥sito. Voc√™ funciona melhor em ambientes colaborativos onde pode influenciar pelo exemplo. Como ${cargo}, seu maior ativo √© como voc√™ faz as pessoas se sentirem.`,
    especialista:`${n}, voc√™ √© um profissional que aprofunda onde outros param. Voc√™ funciona melhor quando pode desenvolver dom√≠nio real em uma √°rea. Sua posi√ß√£o como ${cargo} ser√° constru√≠da na autoridade t√©cnica que voc√™ acumula.`,
    adaptador:`${n}, voc√™ √© algu√©m que performa bem em ambientes que mudam. Voc√™ funciona melhor quando precisa se reinventar e encontrar caminhos alternativos. Como ${cargo}, sua versatilidade √© o que te diferencia.`,
    protagonista:`${n}, voc√™ √© um profissional que quer impacto e visibilidade ‚Äî e tem o que √© preciso para isso. Voc√™ funciona melhor quando tem desafios √† altura do que voc√™ pode entregar. Sua carreira como ${cargo} est√° prestes a avan√ßar de verdade.`,
    transformador:`${n}, voc√™ √© algu√©m que trabalha melhor quando acredita no que est√° fazendo. Voc√™ funciona melhor em ambientes com prop√≥sito claro e impacto real. Como ${cargo}, voc√™ vai longe quando o trabalho tem significado.`,
  };
  return map[archetype]||map.executor;
}

// ‚îÄ‚îÄ OBJECTIVE LABELS ‚îÄ‚îÄ
const OBJ_LABELS = {
  reconhecido:'ser reconhecido e pago pelo que vale',
  crescer:'crescer r√°pido e assumir mais responsabilidade',
  proposito:'trabalhar com prop√≥sito e significado',
  liberdade:'ter liberdade e autonomia profissional',
};
const RESOLVE_LABELS = {
  analise:'an√°lise profunda antes de agir',
  acao:'a√ß√£o r√°pida e ajuste no caminho',
  colabo:'colabora√ß√£o e constru√ß√£o conjunta',
  visao:'vis√£o ampla do cen√°rio antes de decidir',
};
const MOTIVA_LABELS = {
  meta:'metas claras e resultados mensur√°veis',
  criacao:'liberdade para criar do seu jeito',
  desafio:'desafios dif√≠ceis e complexos',
  crescimento:'aprendizado e evolu√ß√£o cont√≠nua',
};
const TRAVA_LABELS = {
  'sem-retorno':'curr√≠culo n√£o gera retorno',
  'vagas-erradas':'aparece em vagas que n√£o quer',
  inseguro:'inseguran√ßa sobre como se apresentar',
  'primeira-vez':'primeira experi√™ncia no processo',
};
const NIVEL_LABELS = {
  iniciante:'iniciante (sem experi√™ncia formal)',
  intermediario:'intermedi√°rio (em crescimento ou transi√ß√£o)',
  avancado:'avan√ßado (construindo marca profissional)',
};

// ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ
window.addEventListener('DOMContentLoaded', async ()=>{
  const raw = sessionStorage.getItem('spp_quiz');
  if(!raw){window.location.href='index.html';return;}
  const Q = JSON.parse(raw);

  // Classify open area if needed
  let area = Q.answers['2']||'adm';
  if(area.startsWith('outro') && Q.openArea){
    area = await classifyOpenArea(Q.openArea);
  }

  const archetypeKey = computeArchetype(Q);
  const archetype = ARCHETYPES[archetypeKey];
  const score = computeScore(archetypeKey, Q);
  const nivel = Q.level||'intermediario';
  const nome = Q.userData.nome||'Voc√™';
  const cargo = Q.userData.cargo||'Profissional';
  const primeiroNome = nome.split(' ')[0];

  // Model key
  const modelKey = nivel==='avancado' ? null : `${nivel}-${area}`;
  const modelName = modelKey ? (MODEL_MAP[modelKey]||MODEL_MAP[`${nivel}-adm`]) : null;
  const price = nivel==='iniciante' ? '27' : '47';
  const priceFrom = nivel==='iniciante' ? '49,99' : '99,99';

  // Build prompt data
  const pdata = {
    archetype: archetype.name,
    objetivo: OBJ_LABELS[Q.answers['3']]||'crescimento profissional',
    resolve: RESOLVE_LABELS[Q.answers['4']]||'an√°lise e execu√ß√£o',
    motiva: MOTIVA_LABELS[Q.answers['5']]||'desafios e resultados',
    trava: TRAVA_LABELS[Q.answers['6']]||'posicionamento',
    area, nivel: NIVEL_LABELS[nivel],
    habilidades: (Q.answers['7']||[]).join(', ')||'n√£o especificadas',
    trajetoria: Q.answers['8']||'n√£o informada',
    nome, cargo,
  };

  // Call Claude API in parallel for all sections
  let perfil='', fortes=[], desenvolver=[], posicionamento='', sobreMim='', softSkills=[];

  try{
    const [p,f,d,pos,sm,ss] = await Promise.all([
      callClaude(PROMPTS.perfil(pdata)),
      callClaude(PROMPTS.fortes(pdata)),
      callClaude(PROMPTS.desenvolver(pdata)),
      callClaude(PROMPTS.posicionamento(pdata)),
      callClaude(PROMPTS.sobreMim(pdata)),
      callClaude(PROMPTS.softSkills(pdata)),
    ]);
    perfil = p||fallbackPerfil(archetypeKey,nome,cargo);
    fortes = f.split('\n').filter(Boolean).slice(0,3);
    desenvolver = d.split('\n').filter(Boolean).slice(0,2);
    posicionamento = pos;
    sobreMim = sm;
    softSkills = ss.split('\n').filter(Boolean).slice(0,4);
  }catch(e){
    perfil = fallbackPerfil(archetypeKey,nome,cargo);
    fortes = ['Capacidade anal√≠tica aplicada ao contexto real','Habilidade de execu√ß√£o orientada a resultado','Facilidade em comunicar valor de forma clara'];
    desenvolver = ['Fortalecer presen√ßa estrat√©gica na √°rea de interesse','Aprofundar compet√™ncias t√©cnicas alinhadas ao objetivo'];
    posicionamento = 'Posicione-se com clareza no que voc√™ entrega, n√£o apenas no que voc√™ faz. Comunique resultados concretos e o impacto que gera.';
    sobreMim = `${primeiroNome} √© um profissional com foco em ${cargo}, buscando ${OBJ_LABELS[Q.answers['3']]||'crescimento'}. Combina ${RESOLVE_LABELS[Q.answers['4']]||'an√°lise e execu√ß√£o'} com motiva√ß√£o em ${MOTIVA_LABELS[Q.answers['5']]||'desafios reais'}. Busca oportunidades que potencializem seu impacto e reconhe√ßam sua capacidade de entrega.`;
    softSkills = ['Execu√ß√£o orientada a resultado','Comunica√ß√£o clara sob press√£o','Adaptabilidade em novos contextos','Aprendizado cont√≠nuo e autogest√£o'];
  }

  // Hide loading, show result
  document.getElementById('loading').style.display='none';
  document.getElementById('result-page').style.display='block';

  if(nivel==='avancado'){
    renderAdvanced(primeiroNome, archetype, score, perfil, fortes, desenvolver, posicionamento, pdata);
  } else {
    renderStandard(primeiroNome, cargo, Q.userData, archetype, score, perfil, fortes, desenvolver, posicionamento, sobreMim, softSkills, pdata, modelName, price, priceFrom, nivel);
  }

  // Animate score bar
  setTimeout(()=>{
    const fill = document.getElementById('score-fill');
    if(fill) fill.style.width = score+'%';
  },300);
});

function renderStandard(nome, cargo, userData, archetype, score, perfil, fortes, desenvolver, posicionamento, sobreMim, softSkills, pdata, modelName, price, priceFrom, nivel){
  const html = `
  <section class="result-hero">
    <div class="result-badge">‚ú¶ An√°lise SPP conclu√≠da</div>
    <h1 class="result-name">${nome},<br>seu perfil √© <em>${archetype.name}.</em></h1>
    <p class="archetype-phrase">${archetype.phrase}</p>
    <div class="score-wrap">
      <div class="score-row">
        <span class="score-label">Score de posicionamento</span>
        <span class="score-num">${score}/100</span>
      </div>
      <div class="score-track"><div class="score-fill" id="score-fill"></div></div>
    </div>
    <p style="font-size:15px;color:rgba(255,255,255,0.5);line-height:1.8;max-width:580px;margin:0 auto;">${perfil}</p>
  </section>

  <section class="analysis">
    <div class="a-inner">
      <p style="font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--amber);">Sua an√°lise completa</p>
      <h2 style="font-size:clamp(22px,3.5vw,36px);font-weight:800;color:#fff;margin-top:10px;letter-spacing:-0.5px;">O que o M√©todo SPP<br>identificou sobre voc√™.</h2>
      <div class="a-grid">
        <div class="a-card">
          <div class="a-card-title" style="color:#4CAF80;">‚úÖ Seus pontos fortes</div>
          ${fortes.map(f=>`<div class="a-item"><div class="a-dot" style="background:#4CAF80;margin-top:8px;"></div>${f}</div>`).join('')}
        </div>
        <div class="a-card">
          <div class="a-card-title" style="color:var(--amber);">üìà O que desenvolver</div>
          ${desenvolver.map(d=>`<div class="a-item"><div class="a-dot" style="background:var(--amber);margin-top:8px;"></div>${d}</div>`).join('')}
        </div>
        <div class="a-card">
          <div class="a-card-title" style="color:#7EB8FF;">üéØ Como se posicionar</div>
          <p style="font-size:14px;color:rgba(255,255,255,0.6);line-height:1.7;">${posicionamento}</p>
        </div>
      </div>
    </div>
  </section>

  <section class="skills-section">
    <div class="sk-inner">
      <p style="font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,0.3);margin-bottom:6px;">Hard skills identificadas</p>
      <div class="sk-tags">
        ${(pdata.habilidades!=='n√£o especificadas'?pdata.habilidades.split(', '):['Habilidades a definir']).map(s=>`<span class="sk-tag">${s}</span>`).join('')}
      </div>
      <p class="sk-title">Compet√™ncias comportamentais</p>
      <div class="sk-tags">
        ${softSkills.map(s=>`<span class="sk-tag" style="background:rgba(255,255,255,0.05);border-color:rgba(255,255,255,0.1);color:rgba(255,255,255,0.6);">${s}</span>`).join('')}
      </div>
    </div>
  </section>

  <section class="transition-block">
    <div class="tb-inner">
      <p class="tb-eyebrow">Seu curr√≠culo SPP</p>
      <h2 class="tb-title">Com base na sua an√°lise,<br>seu curr√≠culo j√° foi constru√≠do.</h2>
      <p class="tb-sub">O sistema preparou um curr√≠culo que comunica exatamente quem voc√™ √© ‚Äî com a linguagem certa, as habilidades certas e o posicionamento certo para a vaga que voc√™ quer. Modelo: <strong style="color:rgba(255,255,255,0.8);">${modelName}</strong>.</p>
    </div>
  </section>

  <section class="cv-preview">
    <div class="cv-inner">
      <div class="cv-device">
        <div class="cv-bar">
          <div class="cv-dot" style="background:#FF5F57;"></div>
          <div class="cv-dot" style="background:#FEBC2E;"></div>
          <div class="cv-dot" style="background:#28C840;"></div>
          <span class="cv-fn">curriculo_${nome.toLowerCase()}_spp.pdf</span>
        </div>
        <div class="cv-body">
          <div class="cv-name">${userData.nome||nome}</div>
          <div class="cv-role">${cargo}</div>
          <div class="cv-contact">
            <span class="cv-ci">üìç ${userData.cidade||'Sua cidade'}</span>
            <span class="cv-ci">‚úâ ${userData.email||'seuemail@exemplo.com'}</span>
            <span class="cv-ci">üì± ${userData.whats||'(11) 00000-0000'}</span>
          </div>
          <div class="cv-line"></div>
          <div class="cv-st">Sobre mim</div>
          <div class="cv-summary">${sobreMim}</div>
          <div class="cv-blur-wrap">
            <div class="cv-blur">
              <div class="cv-st">Habilidades T√©cnicas</div>
              <div style="display:flex;flex-wrap:wrap;gap:7px;margin-bottom:18px;">
                ${[1,2,3,4].map(()=>`<div style="height:24px;width:72px;background:#E6E4DC;border-radius:100px;"></div>`).join('')}
              </div>
              <div class="cv-st">Experi√™ncia Profissional</div>
              <div class="cv-bl" style="width:78%;"></div>
              <div class="cv-bl" style="width:90%;"></div>
              <div class="cv-bl" style="width:55%;margin-bottom:16px;"></div>
              <div class="cv-st">Forma√ß√£o</div>
              <div class="cv-bl" style="width:70%;"></div>
              <div class="cv-bl" style="width:50%;"></div>
            </div>
            <div class="cv-lock">
              <div class="cv-li">üîí</div>
              <div class="cv-lt">Curr√≠culo completo bloqueado</div>
              <div class="cv-ls">Habilidades, experi√™ncia e forma√ß√£o prontos para usar</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="price-section">
    <div class="price-inner">
      <div class="price-card">
        <div class="price-includes">
          <div class="pi-item"><span class="pi-check">‚úì</span>Curr√≠culo ${modelName}</div>
          <div class="pi-item"><span class="pi-check">‚úì</span>PDF para enviar</div>
          <div class="pi-item"><span class="pi-check">‚úì</span>Word edit√°vel</div>
          <div class="pi-item"><span class="pi-check">‚úì</span>ATS-friendly</div>
          <div class="pi-item"><span class="pi-check">‚úì</span>Entrega imediata</div>
          <div class="pi-item"><span class="pi-check">‚úì</span>Garantia 7 dias</div>
        </div>
        <div class="price-from">de R$ ${priceFrom}</div>
        <div class="price-main"><sup>R$</sup>${price}</div>
        <p class="price-note">Pagamento √∫nico ¬∑ Acesso imediato na √°rea de membros<br>e enviado ao seu e-mail</p>
        <button class="btn-buy" onclick="alert('Configurar link Hubla aqui')">
          Desbloquear meu curr√≠culo agora ‚Üí
        </button>
        <div class="price-trust">
          <span>üîí Pagamento seguro</span>
          <span>‚Ü© 7 dias de garantia</span>
          <span>‚ö° Acesso na hora</span>
        </div>
      </div>
    </div>
  </section>`;

  document.getElementById('result-content').innerHTML = html;
}

function renderAdvanced(nome, archetype, score, perfil, fortes, desenvolver, posicionamento, pdata){
  const html = `
  <section class="result-hero">
    <div class="result-badge">‚ú¶ Perfil Avan√ßado identificado</div>
    <h1 class="result-name">Parab√©ns, <em>${nome}.</em></h1>
    <p class="archetype-phrase">${archetype.phrase}</p>
    <div class="score-wrap">
      <div class="score-row">
        <span class="score-label">Score de posicionamento</span>
        <span class="score-num">${score}/100</span>
      </div>
      <div class="score-track"><div class="score-fill" id="score-fill"></div></div>
    </div>
    <p style="font-size:15px;color:rgba(255,255,255,0.5);line-height:1.8;max-width:580px;margin:0 auto;">${perfil}</p>
  </section>

  <section class="analysis">
    <div class="a-inner">
      <p style="font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--amber);">Sua an√°lise completa</p>
      <h2 style="font-size:clamp(22px,3.5vw,36px);font-weight:800;color:#fff;margin-top:10px;letter-spacing:-0.5px;">O M√©todo SPP identificou<br>exatamente quem voc√™ √©.</h2>
      <div class="a-grid">
        <div class="a-card"><div class="a-card-title" style="color:#4CAF80;">‚úÖ Seus pontos fortes</div>${fortes.map(f=>`<div class="a-item"><div class="a-dot" style="background:#4CAF80;margin-top:8px;"></div>${f}</div>`).join('')}</div>
        <div class="a-card"><div class="a-card-title" style="color:var(--amber);">üìà O que desenvolver</div>${desenvolver.map(d=>`<div class="a-item"><div class="a-dot" style="background:var(--amber);margin-top:8px;"></div>${d}</div>`).join('')}</div>
        <div class="a-card"><div class="a-card-title" style="color:#7EB8FF;">üéØ Como se posicionar</div><p style="font-size:14px;color:rgba(255,255,255,0.6);line-height:1.7;">${posicionamento}</p></div>
      </div>
    </div>
  </section>

  <section class="price-section" style="padding-top:0;">
    <div class="price-inner">
      <div class="advanced-block">
        <div class="adv-badge">‚ú¶ N√≠vel Avan√ßado</div>
        <h3 class="adv-title">Para o seu n√≠vel,<br>o curr√≠culo n√£o √© o foco.</h3>
        <p class="adv-text">A sua pr√≥xima alavanca √© como voc√™ √© <strong style="color:#fff;">percebido nas redes</strong> ‚Äî posicionamento, autoridade e atra√ß√£o de oportunidades. Estamos desenvolvendo a <strong style="color:#fff;">An√°lise de Posicionamento SPP</strong> para profissionais exatamente como voc√™.</p>
        <p style="font-size:13px;color:rgba(255,255,255,0.35);font-weight:600;margin-bottom:12px;">Entre na lista de espera e seja o primeiro:</p>
        <div class="adv-form">
          <input id="wl-email" class="adv-input" type="email" placeholder="Seu melhor e-mail">
          <button class="btn-adv" onclick="joinWaitlist()">Quero entrar</button>
        </div>
        <p class="adv-cv-link">Prefere o curr√≠culo agora? <a onclick="showAdvancedCv()">Clique aqui ‚Äî R$47</a></p>
      </div>
    </div>
  </section>`;
  document.getElementById('result-content').innerHTML = html;
}

function joinWaitlist(){
  const email = document.getElementById('wl-email')?.value;
  if(!email) return;
  alert('Voc√™ entrou na lista de espera! Em breve entraremos em contato. üéâ');
}

function showAdvancedCv(){
  // Fallback to standard intermediario flow
  const raw = sessionStorage.getItem('spp_quiz');
  if(raw){
    const Q = JSON.parse(raw);
    Q.level = 'intermediario';
    sessionStorage.setItem('spp_quiz', JSON.stringify(Q));
    window.location.reload();
  }
}
</script>
</body>
</html>
